---
title: "Exploring Data Frames"
subtitle: ""
description: "Materials adapted from Adrien Osakwe, Larisa M. Soto and Xiaoqi Xie."
---

------------------------------------------------------------------------

## 1. Adding Columns and Rows

### 1.1 Individually Adding Columns

You can add a new column by simply assigning values to a name that doesn't exist yet using the `$` operator or bracket `[ , ]` notation.

::: callout-important
**Crucial Rule:** The new column **must** have the exact same number of rows as the existing data frame.
:::

```{r}
# Dataset Preparation

if (!require("gapminder", quietly = TRUE))
    install.packages("gapminder")
library(gapminder)

aust <- gapminder[gapminder$country == "Australia",]
```

```{r}
# Method A: Using the $ operator
# Adding a random column for "mean_children"
mean_children <- sample(1:10, nrow(aust), replace = TRUE)
aust$mean_children <- mean_children

# Adding a calculated column (GDP = population * GDP per capita)
aust$GDP <- aust$pop * aust$gdpPercap

head(aust)
```

```{r}
# Method B: Using bracket notation
mean_bikes <- sample(1:4, nrow(aust), replace = TRUE)
aust[, "mean_bikes"] <- mean_bikes

head(aust)
```

### 1.2 Combining Data Frames by Columns (`cbind`)

If you have a whole table of new data, you can "staple" it to the side of your original data using `cbind()` (column bind).

```{r}
# Create a separate data frame with two new variables
df_new <- data.frame(
  mean_children = sample(1:10, nrow(aust), replace = TRUE),
  mean_bikes = sample(1:4, nrow(aust), replace = TRUE)
)

# Combine them
aust <- cbind(aust, df_new)

head(aust)
```

### 1.3 Adding Rows (`rbind`)

Adding rows is slightly more complex because a row usually contains mixed data types (text, numbers, etc.).

::: callout-note
**Why use a `list` for a new row?** A data frame is a list of vectors. A single row crosses those vectors, so it must be able to hold different types of data at once. A `list` is the perfect container for this.
:::

```{r}
aust <- gapminder[gapminder$country == "Australia",]

# Create a new row as a list
new_row <- list(
  "country" = "Australia",
  "continent" = "Oceania",
  "year" = 2022,
  "lifeExp" = mean(aust$lifeExp),
  "pop" = mean(aust$pop),
  "gdpPercap" = mean(aust$gdpPercap)
)

# Append the row to the bottom
aust <- rbind(aust, new_row)

tail(aust)
```

------------------------------------------------------------------------

## 2. Removing and Filtering Data

### 2.1 Removing Columns and Rows

We use **negative indexing** to drop data.

```{r}
#| collapse: true
aust <- gapminder[gapminder$country == "Australia",]

# Remove the LAST column using its index
aust <- aust[, -ncol(aust)]
dim(aust)

# Remove a column by NAME
# Keep everything where the name is NOT pop
aust <- aust[, colnames(aust) != "pop"]
dim(aust)

# Remove the first 10 rows
aust_reduced <- aust[-(1:10), ]
dim(aust)
```

### 2.2 Applying Filters (Logical Subsetting)

This is how you "query" your data to find specific samples.

```{r}
#| collapse: true
aust <- gapminder[gapminder$country == "Australia",]

# Keep only rows where Life Expectancy is 70 or higher
long_life <- aust[aust$lifeExp >= 70, ]
dim(long_life)

# Keep only rows where GDP is above average
high_gdp <- aust[aust$gdpPercap >= mean(aust$gdpPercap), ]
dim(high_gdp)
```

------------------------------------------------------------------------

## 3. Cleaning Your Data

### 3.1 Handling Duplicates and Empty Rows

Bioinformatics datasets often contain technical replicates or "junk" rows that need to be cleared.

```{r}
#| collapse: true
aust <- gapminder[gapminder$country == "Australia",]

# Remove duplicate rows
aust_unique <- unique(aust)
dim(aust_unique)

# Remove rows that have NA (Missing Values) in a specific column
# First, we identify rows where country is NOT NA
aust_clean <- aust[!is.na(aust$country), ]
dim(aust_clean)
```

### 3.2 Editing Specific Elements

If you find a typo in your data, you can target a single "cell" using `[row, col]`.

```{r}
#| eval: false
# Add 1 year to the Life Expectancy of the first row
aust[1, "lifeExp"] <- aust[1, "lifeExp"] + 1
```
